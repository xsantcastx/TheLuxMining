<header 
  class="fixed inset-x-0 top-0 z-50 transition-all duration-300"
  [class.bg-ts-bg/60]="scrolled" 
  [class.backdrop-blur-sm]="scrolled"
  [class.border-b]="scrolled"
  [class.border-ts-line]="scrolled">
  
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
    <!-- Logo -->
    <a routerLink="/" class="flex items-center gap-3 group">
      <img src="/assets/topstone-mark-dark.svg" alt="TopStone" class="h-8 w-auto"/>
      <span class="font-serif text-xl font-semibold text-ts-ink group-hover:text-ts-accent transition-colors">TopStone</span>
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex items-center gap-8 font-sans text-sm text-ts-ink">
      <a routerLink="/" 
         routerLinkActive="nav-link-active" 
         [routerLinkActiveOptions]="{exact: true}"
         class="nav-link">
        Home
      </a>
      
      <!-- Products Mega Menu -->
      <div class="relative group">
        <a routerLink="/productos"
           routerLinkActive="nav-link-active"
           class="nav-link inline-flex items-center gap-1 py-2">
          Productos
          <svg class="w-4 h-4 transform group-hover:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </a>
        
        <!-- Mega Menu -->
        <div class="invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-all duration-300 absolute right-0 mt-2 w-[920px] -translate-x-[calc(100%-200px)]">
          <div class="p-6 rounded-2xl bg-ts-paper text-black shadow-xl border border-gray-200 grid grid-cols-4 gap-6">
            <!-- 12mm Column -->
            <div>
              <h4 class="font-semibold mb-3 text-ts-bg">12mm (160×320cm)</h4>
              <ul class="space-y-2">
                <li *ngFor="let producto of productos12mm">
                  <a [routerLink]="['/productos', '12mm', producto.slug]" 
                     class="nav-link text-sm block py-1"
                     (mouseenter)="onProductHover(producto)">
                    {{producto.nombre}}
                  </a>
                </li>
              </ul>
            </div>
            
            <!-- 15mm Column -->
            <div>
              <h4 class="font-semibold mb-3 text-ts-bg">15mm (160×320cm)</h4>
              <ul class="space-y-2">
                <li *ngFor="let producto of productos15mm">
                  <a [routerLink]="['/productos', '15mm', producto.slug]" 
                     class="nav-link text-sm block py-1"
                     (mouseenter)="onProductHover(producto)">
                    {{producto.nombre}}
                  </a>
                </li>
              </ul>
            </div>
            
            <!-- 20mm Column -->
            <div>
              <h4 class="font-semibold mb-3 text-ts-bg">20mm (160×320cm)</h4>
              <ul class="space-y-2">
                <li *ngFor="let producto of productos20mm">
                  <a [routerLink]="['/productos', '20mm', producto.slug]" 
                     class="nav-link text-sm block py-1"
                     (mouseenter)="onProductHover(producto)">
                    {{producto.nombre}}
                  </a>
                </li>
              </ul>
            </div>
            
            <!-- Preview Image -->
            <div class="rounded-xl overflow-hidden bg-gray-100">
              <img [src]="hoverPreviewUrl" 
                   alt="Preview" 
                   class="w-full h-full object-cover aspect-[4/3]"
                   loading="lazy"/>
            </div>
          </div>
        </div>
      </div>
      
      <a routerLink="/galeria" 
         routerLinkActive="nav-link-active" 
         class="nav-link">
        Galería
      </a>
      
      <a routerLink="/datos-tecnicos" 
         routerLinkActive="nav-link-active" 
         class="nav-link">
        Datos técnicos
      </a>
      
      <a routerLink="/contacto" 
         routerLinkActive="nav-link-active" 
         class="nav-link">
        Contacto
      </a>
    </nav>

    <!-- Mobile Menu Button -->
    <button 
      class="md:hidden p-2 text-ts-ink hover:text-ts-accent transition-colors"
      (click)="toggleMobileMenu()"
      aria-label="Toggle menu">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              [attr.d]="mobileMenuOpen ? 'M6 18L18 6M6 6l12 12' : 'M4 6h16M4 12h16M4 18h16'">
        </path>
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div 
    class="md:hidden border-t border-ts-line bg-ts-bg/95 backdrop-blur-sm transition-all duration-300"
    [class.opacity-0]="!mobileMenuOpen"
    [class.pointer-events-none]="!mobileMenuOpen"
    [class.opacity-100]="mobileMenuOpen">
    
    <nav class="px-4 py-4 space-y-4">
      <a routerLink="/" 
         class="block text-ts-ink hover:text-ts-accent transition-colors py-2"
         (click)="mobileMenuOpen = false">
        Home
      </a>
      
      <div class="space-y-2">
        <div class="text-ts-ink font-semibold py-2">Productos</div>
        <div class="pl-4 space-y-2">
          <div class="text-sm text-ts-ink-soft">12mm</div>
          <div class="pl-4 space-y-1">
            <a *ngFor="let producto of productos12mm.slice(0, 3)" 
               [routerLink]="['/productos', '12mm', producto.slug]"
               class="block text-ts-ink-soft hover:text-ts-accent transition-colors text-sm py-1"
               (click)="mobileMenuOpen = false">
              {{producto.nombre}}
            </a>
          </div>
        </div>
      </div>
      
      <a routerLink="/galeria" 
         class="block text-ts-ink hover:text-ts-accent transition-colors py-2"
         (click)="mobileMenuOpen = false">
        Galería
      </a>
      
      <a routerLink="/datos-tecnicos" 
         class="block text-ts-ink hover:text-ts-accent transition-colors py-2"
         (click)="mobileMenuOpen = false">
        Datos técnicos
      </a>
      
      <a routerLink="/contacto" 
         class="block text-ts-ink hover:text-ts-accent transition-colors py-2"
         (click)="mobileMenuOpen = false">
        Contacto
      </a>
    </nav>
  </div>
</header>